---
phase: 11-bug-fixes-rendering-foundation
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - AirplaneTracker3D/Rendering/AircraftMeshLibrary.swift
autonomous: false

must_haves:
  truths:
    - "Jets have visibly swept-back wings distinguishable from straight wings on prop planes"
    - "Small prop aircraft have high-mounted straight wings and wider span relative to fuselage"
    - "Helicopters have a visible thin rotor disc even when stationary"
    - "Widebody aircraft have noticeably wider fuselage and longer wings than standard jets"
    - "Military aircraft have triangular/delta wing silhouette different from commercial jets"
    - "Regional jets are visually distinct from standard jets via T-tail configuration"
  artifacts:
    - path: "AirplaneTracker3D/Rendering/AircraftMeshLibrary.swift"
      provides: "Six distinct aircraft category geometries with recognizable silhouettes"
      contains: "buildJet"
  key_links:
    - from: "AirplaneTracker3D/Rendering/AircraftMeshLibrary.swift"
      to: "AirplaneTracker3D/Rendering/AircraftInstanceManager.swift"
      via: "mesh(for:) returns category-specific mesh for instanced rendering"
      pattern: "mesh\\(for:"
---

<objective>
Improve procedural aircraft geometry so each of the 6 categories has a recognizable silhouette when viewed from typical camera distances.

Purpose: Users currently cannot distinguish aircraft categories visually because all shapes use similar rectangular boxes for wings. The success criteria requires "swept wings on jets, straight wings on props, rotors on helicopters, wide fuselage on widebodies."
Output: Six visually distinct aircraft body meshes in AircraftMeshLibrary.
</objective>

<execution_context>
@/Users/mit/.claude/get-shit-done/workflows/execute-plan.md
@/Users/mit/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/11-bug-fixes-rendering-foundation/11-RESEARCH.md
@AirplaneTracker3D/Rendering/AircraftMeshLibrary.swift
</context>

<tasks>

<task type="auto">
  <name>Task 1: Reshape all six aircraft category geometries for distinct silhouettes</name>
  <files>AirplaneTracker3D/Rendering/AircraftMeshLibrary.swift</files>
  <action>
Rewrite the six aircraft body builder methods in AircraftMeshLibrary.swift to produce more distinctive silhouettes. Use ONLY the existing primitive helpers (appendCylinder, appendBox, appendCone, appendSphere). Do NOT add new geometry helpers or import external models.

**Jet (buildJet):**
- Keep fuselage cylinder (r=0.4, h=4) and nose cone
- Make wings swept back: instead of a single centered box, use TWO wing boxes per side, each positioned aft. Left wing: offset SIMD3<Float>(-1.5, 0, -0.3) to shift outboard wing section aft. Right wing: mirror at (+1.5, 0, -0.3). Alternatively, use a single wing box but offset it aft: offset SIMD3<Float>(0, 0, -0.2) so the wing trailing edge extends behind the fuselage center while the leading edge is forward
- Keep engines, tail, and stabilizer as-is
- The key visual change: wings should NOT be centered on the fuselage -- they should be shifted aft to suggest sweep

**Widebody (buildWidebody):**
- Increase fuselage radius to 0.8 (from 0.7) for a more obviously fat fuselage
- Increase wing span to 9.0 (from 8.0) for dramatic wing length
- Add winglet boxes at each wing tip: small vertical boxes (0.06 x 0.5 x 0.15) at offset (+/-4.5, 0.25, 0)
- Keep 4 engines
- The key visual change: dramatically wider wingspan and fatter fuselage

**Helicopter (buildHelicopter):**
- Keep sphere cabin and tail boom
- Add a thin rotor disc (a very flat cylinder or thin box): appendBox with size SIMD3<Float>(5.5, 0.02, 5.5) at offset SIMD3<Float>(0, 0.7, 0). This gives a visible disc even when the rotor blades are not spinning. Use very low height (0.02) so it reads as a flat disc
- Add a rotor mast: thin cylinder from cabin top to disc (r=0.06, h=0.3) at offset (0, 0.55, 0)
- The key visual change: obvious rotor disc overhead distinguishes from all fixed-wing aircraft

**Small Prop (buildSmallProp):**
- Move wings higher: Y offset 0.25 (high-wing Cessna-like configuration) instead of 0
- Increase wing span to 5.0 (from 4.0) for a wider, glider-like proportion
- Keep wings STRAIGHT (no aft offset) -- this is the primary contrast with jets which have swept wings
- Decrease wing chord to 0.6 (from 0.8) for a thinner, more elegant wing profile
- Keep fuselage, nose, tail as-is (smaller radius already distinguishes from jets)
- The key visual change: high-mounted straight wings vs low-mounted swept wings on jets

**Military (buildMilitary):**
- Replace the single rectangular delta wing box with a more delta-shaped arrangement:
  - Root section: wide chord box near fuselage: SIMD3<Float>(2.0, 0.1, 3.0) at center
  - Left outer wing: narrower chord box: SIMD3<Float>(2.5, 0.1, 1.5) at offset (-2.0, 0, -0.5) -- shifted aft to create delta taper
  - Right outer wing: mirror
- Add canard foreplanes: small box SIMD3<Float>(1.5, 0.06, 0.4) at offset (0, 0.1, 1.8) -- forward of the cockpit
- Keep twin angled tails
- The key visual change: obviously triangular wing planform + canards = fighter jet silhouette

**Regional (buildRegional):**
- Change from "0.8x jet" to a distinct shape:
- Fuselage: slightly smaller cylinder (r=0.35, h=3.5)
- Nose cone: proportional (r=0.35, h=0.9)
- Wings: straight, moderate span: SIMD3<Float>(4.5, 0.12, 1.2) -- no aft offset (straighter than jets)
- T-tail: move horizontal stabilizer to TOP of vertical tail. Vertical tail: SIMD3<Float>(0.12, 1.4, 0.9) at offset (0, 0.7, -1.3). Horizontal stabilizer: SIMD3<Float>(2.2, 0.08, 0.5) at offset (0, 1.4, -1.5) -- high Y position creates T-tail
- Engines: 2 engines mounted ON the wings (turboprop style) rather than under: offset at (+/-1.2, 0.1, 0.2) -- above the wing line
- The key visual change: T-tail + wing-mounted engines distinguishes from conventional jets

**Design constraints:**
- All meshes must use ONLY appendCylinder, appendBox, appendCone, appendSphere
- All meshes must produce valid AircraftVertex arrays with correct normals
- Vertex counts must stay within UInt16 index range (65535) -- not an issue for these simple meshes
- Do NOT modify the rotor or propeller meshes (buildRotor, buildPropeller) -- those are handled in Plan 11-01
- Do NOT modify the geometry helper methods themselves
- Do NOT modify createMesh(), the glow texture, or any other existing infrastructure
  </action>
  <verify>
Build the project: `cd /Users/mit/Documents/GitHub/airplane-tracker-3d && xcodebuild -project AirplaneTracker3D.xcodeproj -scheme AirplaneTracker3D -configuration Debug build 2>&1 | tail -5`

Verify each builder method has been updated by checking for the distinguishing features:
- buildJet: wing offset with negative Z (swept)
- buildWidebody: radius 0.8, span 9.0, winglets
- buildHelicopter: thin disc box (5.5 x 0.02 x 5.5)
- buildSmallProp: wing Y offset 0.25, span 5.0
- buildMilitary: canard box at Z=1.8
- buildRegional: horizontal stabilizer Y offset 1.4 (T-tail)
  </verify>
  <done>
All six aircraft category builders produce geometrically distinct silhouettes using existing primitive helpers. Jets have swept wings, small props have high straight wings, helicopters have a rotor disc, widebodies have dramatic wingspan and fat fuselage, military has delta wings with canards, and regionals have T-tails. Project compiles without errors.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Verify aircraft silhouettes are visually distinguishable</name>
  <files>AirplaneTracker3D/Rendering/AircraftMeshLibrary.swift</files>
  <action>
Human verification: Six distinct procedural aircraft meshes with category-specific silhouettes were built in Task 1: swept wings (jet), high straight wings (prop), rotor disc (helicopter), wide fuselage (widebody), delta wings + canards (military), T-tail (regional).

Steps to verify:
1. Run the app: open AirplaneTracker3D.xcodeproj in Xcode, build and run (Cmd+R)
2. Wait for aircraft data to load (~5 seconds)
3. Zoom to a comfortable viewing distance where multiple aircraft are visible (scroll to zoom)
4. Verify you can distinguish at least 3-4 of these categories by shape alone:
   - Jets: Wings angled backward (swept)
   - Small props: Wider straight wings mounted higher, smaller body
   - Helicopters: Visible flat disc on top, spherical cabin
   - Widebodies: Noticeably fatter and longer with very wide wings
5. If available in your area, check for military or regional aircraft and verify they look different from standard jets
6. Try the retro wireframe theme (Cmd+T to cycle) to see silhouettes more clearly in wireframe mode
  </action>
  <verify>Visual inspection confirms at least 3-4 aircraft categories are distinguishable by shape</verify>
  <done>User approves that aircraft categories are visually distinguishable at typical viewing distance, or describes adjustments needed</done>
</task>

</tasks>

<verification>
1. `xcodebuild` succeeds with zero errors for the Debug scheme
2. Each of the 6 builder methods in AircraftMeshLibrary.swift has been updated with distinctive geometry
3. No new geometry helper methods were added (uses only appendCylinder, appendBox, appendCone, appendSphere)
4. Human verification confirms categories are visually distinguishable at typical viewing distance
</verification>

<success_criteria>
- All six aircraft categories have visually distinct silhouettes
- Human can identify at least jets vs props vs helicopters vs widebodies by shape alone
- Project builds and renders correctly with all categories
</success_criteria>

<output>
After completion, create `.planning/phases/11-bug-fixes-rendering-foundation/11-02-SUMMARY.md`
</output>
